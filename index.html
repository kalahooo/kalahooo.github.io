<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
</head>
<body>
    <span>asd</span>
    <script>
        function sha256(str) {
            // transform the string into an arraybuffer.
            const buffer = textEncode(str)

            if (window.msCrypto) {
                // IE 11
                const digest = window.msCrypto.subtle.digest("SHA-256", buffer)
                digest.oncomplete = function (evt) {
                    alert(hex(digest.result))
                }
            } else {
                // not IE

                if (window.crypto && !window.crypto.subtle && window.crypto.webkitSubtle) {
                    window.crypto.subtle = window.crypto.webkitSubtle
                }

                window.crypto.subtle.digest("SHA-256", buffer).then(function (hash) {
                   alert(hex(hash))
                })
            }
        }

        function textEncode(str) {
            if (window.TextEncoder) {
                return new TextEncoder('utf-8').encode(str);
            }
            var utf8 = unescape(encodeURIComponent(str));
            var result = new Uint8Array(utf8.length);
            for (var i = 0; i < utf8.length; i++) {
                result[i] = utf8.charCodeAt(i);
            }
            return result;
        }

        function hex(buffer) {
            var hexCodes = [];
            var view = new DataView(buffer);
            for (var i = 0; i < view.byteLength; i += 4) {
                // Using getUint32 reduces the number of iterations needed (we process 4 bytes each time)
                var value = view.getUint32(i)
                // toString(16) will give the hex representation of the number without padding
                var stringValue = value.toString(16)
                // We use concatenation and slice for padding
                var padding = '00000000'
                var paddedValue = (padding + stringValue).slice(-padding.length)
                hexCodes.push(paddedValue);
            }

          // Join all the hex strings into one
          return hexCodes.join("");
        }

        sha256("foobar")
    </script>
</body>
</html>
